#!/usr/bin/env python3
"""
Malware-like test file - should trigger high risk alerts
"""
import os
import subprocess
import time
import threading

print("Starting malicious operations...")

# Create many files rapidly (high risk)
for i in range(20):
    with open(f'malware_file_{i}.exe', 'w') as f:
        f.write(f"Fake executable content {i}\n")

# Try multiple suspicious commands
suspicious_commands = ['rm', 'del', 'format', 'dd']
for cmd in suspicious_commands:
    try:
        subprocess.run([cmd, '--help'], capture_output=True, timeout=1)
        print(f"Attempted to run: {cmd}")
    except:
        pass

# Try to spawn multiple processes
for i in range(10):
    try:
        subprocess.Popen(['echo', f'process_{i}'], 
                        stdout=subprocess.DEVNULL, 
                        stderr=subprocess.DEVNULL)
    except:
        pass

# Try to access sensitive directories
sensitive_dirs = ['/etc', '/var', '/root', '/home']
for dir_path in sensitive_dirs:
    try:
        if os.path.exists(dir_path):
            print(f"Accessed sensitive directory: {dir_path}")
    except:
        pass

print("Malware test completed!") 